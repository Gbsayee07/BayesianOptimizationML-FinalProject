Step 2 – Model Fitting (Report Section)

In this step, we evaluated whether a Gaussian Process (GP) can model the Branin function accurately using only 32 Sobol-sampled observations. This is an important prerequisite before attempting Bayesian optimization—if the surrogate model is not reliable, optimization cannot succeed.

⸻

1. Branin Training Data (Sobol Sampling)

We generated 32 quasi-random points using a Sobol sequence over the domain
x_1 \in [-5, 10], \quad x_2 \in [0,15].
Sobol sequences are preferred because they cover the input space more uniformly than random sampling. This yields better GP conditioning and a more accurate posterior with fewer points.

⸻

2. Gaussian Process Model Fitting

We fit a GP with:
	•	Constant mean
	•	Squared exponential (RBF) kernel
	•	Fixed very small noise \sigma_n = 0.001
(because Branin is a deterministic function)

We optimized the log marginal likelihood with respect to:
	•	lengthscales: \ell_1, \ell_2
	•	variance \sigma^2
	•	constant mean \mu

The learned hyperparameters were:
	•	\ell = [4.41,\; 22.21]
	•	\sigma^2 \approx 1.71 \times 10^5
	•	\mu \approx 53.82

Interpretation:
The long lengthscale in the x_2 direction (~22) suggests the function varies more slowly with respect to x_2 than x_1.
The large variance indicates substantial variation in Branin relative to the constant mean.

Small Cholesky warnings (“divide by zero”, “overflow”) are expected during kernel hyperparameter optimization and do not impact the final fit.

⸻

3. Posterior Mean and Standard Deviation

Posterior Mean

The GP posterior mean reconstructs the major structure of the Branin function:
	•	It is smooth, as expected from an RBF kernel
	•	Low posterior error near observed data points
	•	High variation towards domain boundaries where Sobol points are sparse

Posterior Standard Deviation

The uncertainty surface behaves exactly as expected:
	•	Nearly zero variance at training points
	•	Smooth growth away from observations
	•	Highest uncertainty in regions sparsely covered by Sobol points

This confirms good GP behavior and validates that the model is numerically stable.

⸻

4. Residual z-score KDE

We computed residuals:
z_i = \frac{f(x_i) - \mu_*(x_i)}{\sigma_*(x_i)}.

If the GP is well-calibrated, these z-scores should follow a standard normal distribution.

Observation:

The KDE is:
	•	Centered around 0
	•	Slightly broader and mildly multimodal
	•	Roughly bell-shaped

This indicates:
	•	The GP captures the general shape of the Branin function
	•	Some slight miscalibration exists—expected with only 32 data points

Overall, the model is sufficiently accurate to proceed to Bayesian optimization.

⸻

Final Summary for Step 2
	•	Sobol sampling provided a well-distributed training set.
	•	The GP fit converged successfully, and the hyperparameters behaved sensibly.
	•	Posterior mean and uncertainty maps match the qualitative shape of the Branin function.
	•	Residuals are approximately Gaussian, showing that the model is reasonably calibrated.